<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content=""/>
  <meta name="author" content="Reber"/>
  
    
      <title>Ubuntu 下安装 sublime text 3 | Reber&#39;s Blog</title>
    
  
  <link rel="stylesheet" href="/css/reset.css"/>
  
  <link rel="stylesheet" href="/css/smigle.css"/>
  
    <link rel="stylesheet" href="/css/monokai-sublime.min.css"/>
  
    <link rel="stylesheet" href="/css/style.css"/>
  
  
    <script src="/js/jquery-3.6.0.min.js"/></script>
  
    <script src="/js/highlight.min.js"/></script>
  
    <script src="/js/style.js"/></script>
  
  <link rel="icon" type="image/img" sizes="16x16" href="/img/logo.png">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
</head>

  <body>
    <header>
  <div id="brand">
    <a class="icon-link" href="https://wyb0.com/">
      <img
        class="icon"
        src="/img/logo.png"
      />
    </a>
    <div class="text">
      <a href="https://wyb0.com/"><h1>Reber&#39;s Blog</h1></a>
      <h3>只会一点点编程、只会一点点渗透</h3>
    </div>
  </div>
  <nav>
    
      
        
        <a href="/"><b>Home</b></a>
      
         | 
        <a href="/posts/"><b>Posts</b></a>
      
         | 
        <a href="/categories/"><b>Categories</b></a>
      
         | 
        <a href="/tags/"><b>Tags</b></a>
      
         | 
        <a href="/about/"><b>About</b></a>
      
         | 
        <a href="/friends/"><b>Friends</b></a>
      
    
  </nav>
  <hr />
</header>

    <div id="content">
      
  <main>
    <article>
      <h1>Ubuntu 下安装 sublime text 3</h1>
      
<div class="post-meta">
    <time>2016-05-08</time>
    
    [<a href="/categories/Linux">Linux</a>](<a href="/tags/software">software</a>)
</div>

      <div><p>环境：ubuntu14.4</p>
<h3 id="0x00-安装">0x00 安装</h3>
<ol>
<li>
<p>添加Sublime Text 3的仓库<br>
sudo add-apt-repository ppa:webupd8team/sublime-text-3</p>
</li>
<li>
<p>更新软件库<br>
sudo apt-get update</p>
</li>
<li>
<p>安装Sublime Text 3<br>
sudo apt-get install sublime-text-installer</p>
</li>
</ol>
<h3 id="0x01-解决不能输入中文的问题">0x01 解决不能输入中文的问题</h3>
<ol>
<li>新建sublime_imfix.c(位于～目录)，写入如下内容</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;gtk/gtkimcontext.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">gtk_im_context_set_client_window</span> (GtkIMContext <span style="color:#f92672">*</span>context,GdkWindow  <span style="color:#f92672">*</span>window)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>GtkIMContextClass <span style="color:#f92672">*</span>klass;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">g_return_if_fail</span> (<span style="color:#a6e22e">GTK_IS_IM_CONTEXT</span> (context));
</span></span><span style="display:flex;"><span>klass <span style="color:#f92672">=</span> <span style="color:#a6e22e">GTK_IM_CONTEXT_GET_CLASS</span> (context);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (klass<span style="color:#f92672">-&gt;</span>set_client_window)
</span></span><span style="display:flex;"><span>    klass<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">set_client_window</span> (context, window);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">g_object_set_data</span>(<span style="color:#a6e22e">G_OBJECT</span>(context),<span style="color:#e6db74">&#34;window&#34;</span>,window);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">GDK_IS_WINDOW</span> (window))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> width <span style="color:#f92672">=</span> <span style="color:#a6e22e">gdk_window_get_width</span>(window);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> height <span style="color:#f92672">=</span> <span style="color:#a6e22e">gdk_window_get_height</span>(window);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(width <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> height <span style="color:#f92672">!=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">gtk_im_context_focus_in</span>(context);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="2">
<li>将上一步的代码编译成共享库libsublime-imfix.so</li>
</ol>
<pre tabindex="0"><code>cd ~  
sudo apt-get install gtk+-2.0  
gcc -shared -o libsublime-imfix.so sublime_imfix.c  `pkg-config --libs --cflags gtk+-2.0` -fPIC
</code></pre><ol start="3">
<li>
<p>将libsublime-imfix.so拷贝到sublime_text所在文件夹<br>
<code>sudo mv libsublime-imfix.so /opt/sublime_text/</code></p>
</li>
<li>
<p>修改文件/usr/bin/subl的内容</p>
</li>
</ol>
<pre tabindex="0"><code>sudo vim /usr/bin/subl  
将  
#!/bin/sh  
exec /opt/sublime_text/sublime_text &#34;$@&#34;  
修改为  
#!/bin/sh  
LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so
exec /opt/sublime_text/sublime_text &#34;$@&#34;
</code></pre><ol start="5">
<li>使用鼠标右键打开文件时能够使用中文输入<br>
sudo vim /usr/share/applications/sublime_text.desktop</li>
</ol>
<pre tabindex="0"><code>    将[Desktop Entry]中的字符串  
    Exec=/opt/sublime_text/sublime_text %F  
    修改为  
    Exec=bash -c &#34;LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text %F&#34;  

    将[Desktop Action Window]中的字符串  
    Exec=/opt/sublime_text/sublime_text -n  
    修改为  
    Exec=bash -c &#34;LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text -n&#34;  

    将[Desktop Action Document]中的字符串  
    Exec=/opt/sublime_text/sublime_text --command new_file  
    修改为  
    Exec=bash -c &#34;LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text --command new_file&#34;
</code></pre><h3 id="0x02-插件">0x02 插件</h3>
<ul>
<li>Anaconda</li>
<li>ConvertToUTF8</li>
<li>Emmet</li>
</ul>
</div>
    </article>
  </main>

    </div>
    <footer>
  <hr />
  
    <p id="social">
      Find me around the web:
      
        
        <a href="https://github.com/reber0?_blank">GitHub</a>
      
         • 
        <a href="https://weibo.com/u/5819760166?_blank">Weibo</a>
      
    </p>
  
  <p class="copyright">
    Copyright © 2015-2023
    <a href="https://wyb0.com/"><strong>Reber</strong></a>.

    Built with
    <a href="http://www.gohugo.io/">Hugo</a>,
    based on the theme
    <a href="https://gitlab.com/ian-s-mcb/smigle-hugo-theme">smigle</a>.
  </p>
</footer>

  </body>
</html>
